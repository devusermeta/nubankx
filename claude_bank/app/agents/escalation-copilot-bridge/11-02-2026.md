# Escalation Agent Migration Issue - February 11, 2026

## Problem Summary

**Goal**: Replace MCP-based escalation agent with Copilot Studio agent for A2A protocol integration.

**Multi-Tenant Setup**:
- **metakaal tenant**: Contains Azure resources and Copilot Studio environment
- **bankxthb tenant**: Contains application users (natta@bankxthb.onmicrosoft.com)

**Current Issue**: Microsoft Graph API permissions not granted for EscalationBridgeApp.

## Root Cause

**Permission Consent Failure**: 
```
Application ID: 5617a009-e330-4535-8431-98415c884b60
Tenant: c1e8c736-fd22-4d7b-a7a2-12c6f36ac388 (metakaal)
Error: "Consent for application permissions can only be performed by an administrator"
```

**Missing Permissions**:
- ✅ Microsoft Graph - Files.ReadWrite.All (Application) - ⚠️ NOT CONSENTED
- ✅ Microsoft Graph - Mail.Send (Application) - ⚠️ NOT CONSENTED

**Issue**: User (Abhinav@metakaal.com) lacks admin rights in metakaal tenant to grant application permissions.

## Solution

### Immediate Action Required
Contact **metakaal tenant administrator** to grant admin consent:

**Admin Task**:
1. Go to Azure Portal → Azure Active Directory → App registrations
2. Find **EscalationBridgeApp** (ID: 5617a009-e330-4535-8431-98415c884b60)
3. Navigate to **API permissions**
4. Click **"✓ Grant admin consent for Metakaal Pte Ltd"**

### Architecture Validation
✅ **Correct Setup**:
- Copilot Studio environment: metakaal tenant
- Excel file location: Abhinav@metakaal.com OneDrive
- Email sender: abhinav@metakaal.com
- A2A integration: Port 9006 (FastAPI bridge)

### Post-Consent Steps
1. Run `python setup_check.py` to verify permissions
2. Start A2A bridge with `python main.py`
3. Update agent registry to use new endpoint

## Expected Timeline
- **Admin consent**: Same day (pending admin availability)
- **Testing**: 1-2 hours after consent
- **A2A integration**: Ready for production

## Files & Resources
- Bridge code: `claude_bank/app/agents/escalation-copilot-bridge/`
- Configuration: `.env` file (credentials secured)
- Documentation: `SETUP_COMPLETED.md`, `COPILOT_STUDIO_DIRECT_CONNECTORS_GUIDE.md`

---
**Status**: ⚠️ Waiting for admin consent  
**Next Action**: Contact metakaal tenant administrator  
**ETA**: Same day resolution possible